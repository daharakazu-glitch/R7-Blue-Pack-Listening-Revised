<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>青パック 英語リスニング 解答・解説 重要語句復習アプリ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Inter"', '"Noto Sans JP"', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: 100vh;
        }
        .card {
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            padding: 24px;
            border: 1px solid rgba(255, 255, 255, 0.7);
        }
        @media (min-width: 640px) {
            .card { padding: 32px; }
        }
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        .btn:active { transform: scale(0.98); }
        .btn-primary { background: #0ea5e9; color: white; }
        .btn-primary:hover { background: #0284c7; }
        .btn-secondary { background: white; color: #475569; border: 1px solid #e2e8f0; }
        .btn-green { background: #10b981; color: white; }
        .btn-red { background: #ef4444; color: white; }
        .btn-orange { background: #f97316; color: white; }
        .btn-disabled { background: #cbd5e1; color: #94a3b8; cursor: not-allowed; }
        
        .hidden { display: none !important; }
        
        /* Quiz & Flashcard Styles */
        .quiz-option {
            border: 2px solid #f1f5f9;
            padding: 16px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
        }
        .quiz-option:hover { border-color: #0ea5e9; background-color: #f0f9ff; }
        .quiz-option.correct { border-color: #10b981; background-color: #d1fae5; color: #065f46; }
        .quiz-option.incorrect { border-color: #ef4444; background-color: #fee2e2; color: #991b1b; }
        
        #mic-icon.recording { animation: pulse 1.5s infinite; color: white; }
        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { transform: scale(1.1); box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }

        .word-checkbox {
            width: 1.25rem;
            height: 1.25rem;
            color: #0ea5e9;
            border-radius: 0.25rem;
            border-color: #cbd5e1;
        }
    </style>
</head>
<body class="text-slate-800 antialiased">

    <div id="app" class="max-w-4xl mx-auto p-4 sm:p-8">
        <header class="text-center mb-10">
            <div class="inline-block p-2 bg-white rounded-2xl shadow-sm mb-4">
                <span class="px-3 py-1 bg-brand-100 text-brand-600 rounded-lg text-xs font-bold tracking-wider uppercase">Listening Practice</span>
            </div>
            <h1 class="text-2xl sm:text-3xl md:text-4xl font-extrabold text-slate-900 tracking-tight leading-tight">
                <span class="text-brand-600">青パック 英語リスニング</span><br>
                解答・解説 重要語句復習
            </h1>
        </header>

        <!-- Setup Section -->
        <section id="setup-section" class="card space-y-8 animate-fade-in">
            <div>
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-slate-800 flex items-center">
                        <span class="flex items-center justify-center w-8 h-8 rounded-full bg-brand-100 text-brand-600 text-sm mr-3">1</span>
                        学習する単語を選択
                    </h2>
                    <div class="flex space-x-2">
                        <button id="select-all" class="text-xs font-medium text-brand-600 hover:text-brand-700 hover:bg-brand-50 px-3 py-1.5 rounded-lg transition">すべて選択</button>
                        <button id="deselect-all" class="text-xs font-medium text-slate-500 hover:text-slate-700 hover:bg-slate-100 px-3 py-1.5 rounded-lg transition">すべて解除</button>
                    </div>
                </div>
                
                <div class="bg-slate-50 border border-slate-200 rounded-xl p-4">
                    <div id="word-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 max-h-[60vh] overflow-y-auto pr-2">
                        <!-- Words will be injected here via JS -->
                        <div class="col-span-full text-center text-slate-400 py-8">読み込み中...</div>
                    </div>
                </div>
            </div>

            <div>
                <h2 class="text-xl font-bold text-slate-800 mb-4 flex items-center">
                    <span class="flex items-center justify-center w-8 h-8 rounded-full bg-brand-100 text-brand-600 text-sm mr-3">2</span>
                    学習モードを選択
                </h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <label class="relative flex items-center p-4 border border-slate-200 rounded-xl cursor-pointer hover:bg-slate-50 hover:border-brand-300 transition-all group bg-white">
                        <input type="radio" name="mode" value="word" class="peer sr-only" checked>
                        <div class="w-5 h-5 border-2 border-slate-300 rounded-full mr-3 peer-checked:border-brand-500 peer-checked:bg-brand-500 relative"></div>
                        <div class="flex flex-col">
                            <span class="font-bold text-slate-700 peer-checked:text-brand-700">単語・フレーズのみ</span>
                            <span class="text-xs text-slate-500 mt-1">基本的な意味を覚える</span>
                        </div>
                        <div class="absolute inset-0 border-2 border-transparent peer-checked:border-brand-500 rounded-xl pointer-events-none"></div>
                    </label>
                    <label class="relative flex items-center p-4 border border-slate-200 rounded-xl cursor-pointer hover:bg-slate-50 hover:border-brand-300 transition-all group bg-white">
                        <input type="radio" name="mode" value="sentence" class="peer sr-only">
                        <div class="w-5 h-5 border-2 border-slate-300 rounded-full mr-3 peer-checked:border-brand-500 peer-checked:bg-brand-500 relative"></div>
                        <div class="flex flex-col">
                            <span class="font-bold text-slate-700 peer-checked:text-brand-700">例文で学習</span>
                            <span class="text-xs text-slate-500 mt-1">文脈から推測・リスニング</span>
                        </div>
                        <div class="absolute inset-0 border-2 border-transparent peer-checked:border-brand-500 rounded-xl pointer-events-none"></div>
                    </label>
                </div>
            </div>

            <div class="pt-4 flex flex-col sm:flex-row gap-4 justify-center items-center border-t border-slate-100">
                <button id="start-learning-btn" class="btn btn-primary w-full sm:w-auto text-lg min-w-[200px]">
                    <i class="fas fa-play mr-2 text-sm"></i> 学習を開始
                </button>
                <button id="quick-test-btn" class="btn btn-orange w-full sm:w-auto text-lg">
                    <i class="fas fa-random mr-2"></i> ランダムテスト
                </button>
                <button id="download-pdf-btn" class="btn btn-green w-full sm:w-auto text-lg">
                    <i class="fas fa-file-pdf mr-2 text-white"></i> PDF作成
                </button>
            </div>
        </section>

        <!-- Learning Section -->
        <section id="learning-section" class="card hidden flex flex-col h-auto min-h-[600px]">
            <div class="flex justify-between items-center mb-6">
                 <button id="back-to-setup-btn" class="text-sm text-slate-500 hover:text-slate-800 flex items-center transition">
                    <i class="fas fa-arrow-left mr-2"></i> 戻る
                </button>
                <div class="bg-slate-100 px-4 py-1.5 rounded-full">
                    <span id="progress-indicator" class="text-sm font-bold text-slate-600 font-mono"></span>
                </div>
                <div class="w-16"></div>
            </div>
            
            <div class="flex-grow flex flex-col justify-center mb-8">
                <div id="flashcard-container" class="relative w-full cursor-pointer group">
                    <div class="relative w-full min-h-[350px] bg-white rounded-2xl border-2 border-slate-100 shadow-sm hover:border-brand-200 transition-all duration-300 flex flex-col items-center justify-center p-6 text-center">
                        <div class="w-full flex flex-col items-center">
                            <div id="illustration-area" class="hidden mb-6 text-brand-500">
                                <i class="fas fa-book-open text-5xl opacity-80"></i>
                            </div>
                            <p id="english-text" class="text-3xl sm:text-4xl md:text-5xl font-bold text-slate-800 mb-6 leading-tight select-text"></p>
                            <div id="japanese-wrapper" class="h-auto min-h-[4rem] transition-all duration-300 opacity-0 transform translate-y-4">
                                <p id="japanese-text" class="text-xl sm:text-2xl text-brand-600 font-medium"></p>
                            </div>
                            <p class="text-xs text-slate-400 mt-8 uppercase tracking-widest">Click to reveal</p>
                        </div>
                    </div>
                </div>
                <div id="pronunciation-feedback-container" class="mt-6 min-h-[60px]"></div>
            </div>

            <div class="mt-auto">
                <div class="flex justify-center items-center space-x-6 mb-8">
                    <button id="speak-btn" class="btn btn-secondary rounded-full w-14 h-14 p-0 flex items-center justify-center shadow-sm" title="音声を聞く">
                        <i class="fas fa-volume-up text-xl"></i>
                    </button>
                    <button id="record-btn" class="btn btn-red rounded-full w-16 h-16 p-0 flex items-center justify-center shadow-lg" title="発音練習">
                        <i id="mic-icon" class="fas fa-microphone text-2xl"></i>
                    </button>
                    <button id="play-recording-btn" class="btn btn-green btn-disabled rounded-full w-14 h-14 p-0 flex items-center justify-center shadow-sm" disabled title="自分の声を聞く">
                        <i class="fas fa-play text-xl"></i>
                    </button>
                </div>
                <audio id="recording-player" class="hidden"></audio>

                <div class="flex justify-between items-center gap-2">
                    <button id="prev-btn" class="btn btn-secondary px-4 sm:px-6"><i class="fas fa-chevron-left mr-2"></i> <span class="hidden sm:inline">前へ</span></button>
                    <button id="start-test-btn" class="btn btn-primary flex-grow sm:flex-grow-0 px-8 shadow-md">テストへ <i class="fas fa-graduation-cap ml-2"></i></button>
                    <button id="next-btn" class="btn btn-secondary px-4 sm:px-6"><span class="hidden sm:inline">次へ</span> <i class="fas fa-chevron-right ml-2"></i></button>
                </div>
            </div>
        </section>

        <!-- Test Options & Quiz Sections -->
        <section id="test-options-section" class="card hidden text-center py-16">
            <h2 class="text-3xl font-bold text-slate-800 mb-8">テスト問題数を選択</h2>
            <div id="test-choices" class="flex flex-wrap justify-center gap-4 mb-12"></div>
            <button id="back-to-learning-btn" class="text-slate-500 hover:text-slate-800 font-medium">戻る</button>
        </section>

        <section id="quiz-section" class="card hidden">
            <div class="flex justify-between items-center mb-6 pb-4 border-b border-slate-100">
                 <h2 class="text-xl font-bold text-slate-800">テスト中 <span id="quiz-progress" class="ml-2 text-sm bg-brand-100 text-brand-700 px-2 py-1 rounded"></span></h2>
                 <button id="abort-test-btn" class="text-sm text-red-500">中断</button>
            </div>
            <div class="mb-8 text-center">
                <p class="text-sm text-slate-400 mb-2 uppercase">Question</p>
                <p id="quiz-question" class="text-3xl sm:text-4xl font-bold text-slate-800 mb-8"></p>
                <div id="quiz-options" class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-left"></div>
            </div>
            <div id="feedback" class="text-center font-bold my-4 min-h-[40px] flex items-center justify-center text-lg"></div>
            <div class="text-center h-14">
                 <button id="next-question-btn" class="hidden btn btn-primary px-8">次へ <i class="fas fa-arrow-right ml-2"></i></button>
            </div>
        </section>

        <section id="results-section" class="card hidden text-center py-12">
            <div class="mb-6"><span class="text-5xl font-bold text-brand-600" id="score-percentage"></span></div>
            <p id="score-text" class="text-xl text-slate-600 mb-8"></p>
            <div id="incorrect-answers-container" class="text-left bg-red-50 border border-red-100 rounded-xl p-6 mb-8 hidden">
                <h3 class="text-lg font-bold text-red-800 mb-4">復習リスト</h3>
                <ul id="incorrect-answers-list" class="space-y-3"></ul>
            </div>
            <div class="flex flex-col sm:flex-row justify-center gap-4">
                <button id="restart-btn" class="btn btn-primary">もう一度</button>
                <button id="back-to-home-btn" class="btn btn-secondary">ホーム</button>
            </div>
        </section>
    </div>

    <!-- PDF Modal -->
    <div id="pdf-modal" class="hidden fixed inset-0 bg-slate-900/50 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-lg overflow-hidden shadow-2xl">
            <div class="bg-slate-50 px-6 py-4 border-b flex justify-between items-center">
                <h3 class="text-lg font-bold">PDF作成</h3>
                <button id="close-modal-icon" class="text-slate-400"><i class="fas fa-times"></i></button>
            </div>
            <div class="p-6 grid grid-cols-1 gap-3">
                <button id="download-list-btn" class="p-3 border rounded-lg hover:bg-brand-50 hover:border-brand-500 text-left font-bold text-slate-700">1. 単語リスト</button>
                <button id="download-en-quiz-btn" class="p-3 border rounded-lg hover:bg-brand-50 hover:border-brand-500 text-left font-bold text-slate-700">2. 英単語テスト</button>
                <button id="download-ja-quiz-btn" class="p-3 border rounded-lg hover:bg-brand-50 hover:border-brand-500 text-left font-bold text-slate-700">3. 和訳テスト</button>
                <button id="download-mixed-quiz-btn" class="p-3 border rounded-lg hover:bg-brand-50 hover:border-brand-500 text-left font-bold text-slate-700">4. 混合テスト</button>
                <button id="download-sentence-quiz-btn" class="p-3 border rounded-lg hover:bg-brand-50 hover:border-brand-500 text-left font-bold text-slate-700">5. 例文穴埋め</button>
                <button id="download-sentence-mixed-quiz-btn" class="p-3 border rounded-lg hover:bg-brand-50 hover:border-brand-500 text-left font-bold text-slate-700">6. 例文実戦テスト</button>
            </div>
            <div class="bg-slate-50 px-6 py-3 border-t text-right">
                <button id="close-modal-btn" class="text-sm font-medium text-slate-500">閉じる</button>
            </div>
        </div>
    </div>

    <script>
        // --- DATA EXTRACTED FROM PDF ---
        const vocabularyData = [
            { "english": "go see", "japanese": "･･･を見に行く", "sentence": "Let's go see the new movie.", "sentence_ja": "その新しい映画を見に行こう。" },
            { "english": "instead", "japanese": "その代わりに", "sentence": "I'll have tea instead of coffee.", "sentence_ja": "コーヒーの代わりに紅茶をいただきます。" },
            { "english": "suggest", "japanese": "･･･を提案する", "sentence": "I suggest we leave early.", "sentence_ja": "早く出発することを提案します。" },
            { "english": "be willing to", "japanese": "-するのをいとわない", "sentence": "I am willing to help you.", "sentence_ja": "私はあなたを助けるのをいといません。" },
            { "english": "instead of...", "japanese": "･･･の代わりに", "sentence": "Use honey instead of sugar.", "sentence_ja": "砂糖の代わりに蜂蜜を使いなさい。" },
            { "english": "bookcase", "japanese": "本箱:本棚", "sentence": "The bookcase is full of books.", "sentence_ja": "その本棚は本でいっぱいだ。" },
            { "english": "by oneself", "japanese": "1人で: 自力で", "sentence": "He built the house by himself.", "sentence_ja": "彼は自力でその家を建てた。" },
            { "english": "need help -ing", "japanese": "･･･するのに助けが必要だ", "sentence": "I need help moving this sofa.", "sentence_ja": "このソファを動かすのに助けが必要だ。" },
            { "english": "order", "japanese": "･･･を注文する", "sentence": "May I order now?", "sentence_ja": "今注文してもいいですか？" },
            { "english": "tool", "japanese": "道具", "sentence": "He has a box of tools.", "sentence_ja": "彼は道具箱を持っている。" },
            { "english": "assembly", "japanese": "組み立て", "sentence": "The assembly instructions are clear.", "sentence_ja": "組み立て説明書はわかりやすい。" },
            { "english": "recommend", "japanese": "･･･を勧める", "sentence": "I recommend this restaurant.", "sentence_ja": "私はこのレストランを勧めます。" },
            { "english": "delicious", "japanese": "おいしい", "sentence": "This cake is delicious.", "sentence_ja": "このケーキはおいしい。" },
            { "english": "such", "japanese": "あんなに:そんなに:こんなに", "sentence": "I've never seen such a big dog.", "sentence_ja": "あんなに大きな犬は見たことがない。" },
            { "english": "before", "japanese": "今まで(に);以前に", "sentence": "Have we met before?", "sentence_ja": "以前お会いしましたか？" },
            { "english": "sign up for...", "japanese": "･･･に申し込む", "sentence": "I signed up for the gym.", "sentence_ja": "私はジムに申し込んだ。" },
            { "english": "most recent", "japanese": "直近の", "sentence": "This is his most recent work.", "sentence_ja": "これが彼の直近の作品だ。" },
            { "english": "attend", "japanese": "･･･に参加する", "sentence": "I will attend the meeting.", "sentence_ja": "私は会議に参加します。" },
            { "english": "register for...", "japanese": "･･･に登録する", "sentence": "Register for the course online.", "sentence_ja": "オンラインでコースに登録しなさい。" },
            { "english": "miss the deadline for...", "japanese": "･･･の締め切りに間に合わない", "sentence": "Don't miss the deadline for the report.", "sentence_ja": "レポートの締め切りに遅れないように。" },
            { "english": "talk to...", "japanese": "･･･と話す:･･･に話しかける", "sentence": "I need to talk to you.", "sentence_ja": "あなたと話す必要がある。" },
            { "english": "call out", "japanese": "大声で叫ぶ", "sentence": "He called out my name.", "sentence_ja": "彼は私の名前を大声で呼んだ。" },
            { "english": "branch", "japanese": "枝", "sentence": "The bird is on the branch.", "sentence_ja": "鳥が枝にとまっている。" },
            { "english": "topmost", "japanese": "一番上の", "sentence": "The apple on the topmost branch looks sweet.", "sentence_ja": "一番上の枝のリンゴは甘そうだ。" },
            { "english": "wide", "japanese": "幅が広い", "sentence": "The river is very wide here.", "sentence_ja": "その川はここではとても幅が広い。" },
            { "english": "one", "japanese": "もの", "sentence": "I want the red one.", "sentence_ja": "私は赤いものが欲しい。" },
            { "english": "shoulder strap", "japanese": "肩かけストラップ", "sentence": "This bag comes with a shoulder strap.", "sentence_ja": "このバッグには肩かけストラップがついている。" },
            { "english": "neither", "japanese": "どちらも･･･ない", "sentence": "Neither of them came.", "sentence_ja": "彼らのどちらも来なかった。" },
            { "english": "beside", "japanese": "･･･の横に:･･･の側に", "sentence": "Sit beside me.", "sentence_ja": "私の横に座りなさい。" },
            { "english": "plant", "japanese": "植物", "sentence": "Water the plants every day.", "sentence_ja": "毎日植物に水をやりなさい。" },
            { "english": "ceiling", "japanese": "天井", "sentence": "The room has a high ceiling.", "sentence_ja": "その部屋は天井が高い。" },
            { "english": "heavily", "japanese": "激しく", "sentence": "It rained heavily yesterday.", "sentence_ja": "昨日は激しく雨が降った。" },
            { "english": "mine", "japanese": "私のもの", "sentence": "That book is mine.", "sentence_ja": "その本は私のものだ。" },
            { "english": "guess", "japanese": "推測する", "sentence": "Can you guess my age?", "sentence_ja": "私の年齢を推測できますか？" },
            { "english": "striped", "japanese": "しま模様の", "sentence": "He wore a striped shirt.", "sentence_ja": "彼はしま模様のシャツを着ていた。" },
            { "english": "look for...", "japanese": "･･･を探す", "sentence": "I'm looking for my keys.", "sentence_ja": "私は鍵を探している。" },
            { "english": "patterned", "japanese": "模様のある", "sentence": "I prefer patterned wallpaper.", "sentence_ja": "私は模様のある壁紙の方が好きだ。" },
            { "english": "round", "japanese": "丸い", "sentence": "The table is round.", "sentence_ja": "そのテーブルは丸い。" },
            { "english": "take", "japanese": "･･･を利用する:･･･に乗って行く", "sentence": "Let's take a taxi.", "sentence_ja": "タクシーを利用しよう。" },
            { "english": "harbor", "japanese": "港", "sentence": "The ship entered the harbor.", "sentence_ja": "船が港に入った。" },
            { "english": "be likely to", "japanese": "-そうである", "sentence": "It is likely to rain.", "sentence_ja": "雨が降りそうだ。" },
            { "english": "drop by", "japanese": "･･･に立ち寄る", "sentence": "Please drop by my office.", "sentence_ja": "私のオフィスに立ち寄ってください。" },
            { "english": "straight", "japanese": "まっすぐに", "sentence": "Go straight down this street.", "sentence_ja": "この通りをまっすぐ行きなさい。" },
            { "english": "already", "japanese": "すでに", "sentence": "I have already finished my homework.", "sentence_ja": "私はすでに宿題を終えた。" },
            { "english": "somewhere", "japanese": "どこかで", "sentence": "Let's go somewhere warm.", "sentence_ja": "どこか暖かいところへ行こう。" },
            { "english": "be lined up", "japanese": "･･･に並ばされている", "sentence": "The chairs are lined up.", "sentence_ja": "椅子が一列に並べられている。" },
            { "english": "besides", "japanese": "さらに", "sentence": "Besides, it's too expensive.", "sentence_ja": "さらに、それは高すぎる。" },
            { "english": "eat out", "japanese": "外食する", "sentence": "We eat out on Fridays.", "sentence_ja": "私たちは金曜日に外食する。" },
            { "english": "cost", "japanese": "(費用・金額)がかかる", "sentence": "It costs a lot of money.", "sentence_ja": "それは多額の費用がかかる。" },
            { "english": "save", "japanese": "･･･を貯蓄する", "sentence": "I'm saving money for a car.", "sentence_ja": "私は車のために貯金している。" },
            { "english": "What about...?", "japanese": "･･･はどうですか?", "sentence": "What about going to the park?", "sentence_ja": "公園に行くのはどうですか？" },
            { "english": "take", "japanese": "･･･を持っていく", "sentence": "Take an umbrella with you.", "sentence_ja": "傘を持っていきなさい。" },
            { "english": "appointment", "japanese": "(医師などとの)予約", "sentence": "I have a doctor's appointment.", "sentence_ja": "私は医者の予約がある。" },
            { "english": "patient", "japanese": "患者", "sentence": "The doctor examined the patient.", "sentence_ja": "医者は患者を診察した。" },
            { "english": "priority", "japanese": "優先権", "sentence": "Safety is our top priority.", "sentence_ja": "安全が私たちの最優先事項だ。" },
            { "english": "in a hurry", "japanese": "急いで", "sentence": "He left in a hurry.", "sentence_ja": "彼は急いで出て行った。" },
            { "english": "paper", "japanese": "レポート", "sentence": "I have to write a paper.", "sentence_ja": "私はレポートを書かなければならない。" },
            { "english": "hand in", "japanese": "･･･を提出する", "sentence": "Hand in your homework tomorrow.", "sentence_ja": "明日宿題を提出しなさい。" },
            { "english": "cancel", "japanese": "･･･を中止する", "sentence": "The flight was canceled.", "sentence_ja": "フライトは中止された。" },
            { "english": "actually", "japanese": "実は", "sentence": "Actually, I don't know him.", "sentence_ja": "実は、私は彼を知らない。" },
            { "english": "submit", "japanese": "･･･を提出する", "sentence": "Please submit your application.", "sentence_ja": "申請書を提出してください。" },
            { "english": "exit", "japanese": "出口", "sentence": "Where is the emergency exit?", "sentence_ja": "非常口はどこですか？" },
            { "english": "How about...?", "japanese": "･･･はどうですか?", "sentence": "How about a cup of coffee?", "sentence_ja": "コーヒーを一杯いかがですか？" },
            { "english": "I'm afraid...", "japanese": "(申し訳ないが)･･･", "sentence": "I'm afraid I can't come.", "sentence_ja": "申し訳ないが、行けません。" },
            { "english": "exactly", "japanese": "きっかり:ちょうど", "sentence": "It's exactly 10 o'clock.", "sentence_ja": "ちょうど10時だ。" },
            { "english": "mind", "japanese": "･･･を嫌に思う", "sentence": "Do you mind if I smoke?", "sentence_ja": "タバコを吸ってもいいですか（嫌に思いますか）？" },
            { "english": "take one's time", "japanese": "ゆっくりやる", "sentence": "Take your time, there's no rush.", "sentence_ja": "ゆっくりやって、急ぐ必要はないよ。" },
            { "english": "what's more", "japanese": "おまけに", "sentence": "It's cheap, and what's more, it's good.", "sentence_ja": "それは安く、おまけに良い。" },
            { "english": "bargain", "japanese": "掘り出し物", "sentence": "This coat was a real bargain.", "sentence_ja": "このコートは本当に掘り出し物だった。" },
            { "english": "several", "japanese": "いくつかの", "sentence": "I have several questions.", "sentence_ja": "いくつか質問があります。" },
            { "english": "still", "japanese": "それでも", "sentence": "He is old, but still active.", "sentence_ja": "彼は年老いているが、それでも活動的だ。" },
            { "english": "discount", "japanese": "割引", "sentence": "Can I get a discount?", "sentence_ja": "割引してもらえますか？" },
            { "english": "enough", "japanese": "十分な", "sentence": "We have enough food.", "sentence_ja": "十分な食料がある。" },
            { "english": "deal", "japanese": "お買い得の品", "sentence": "That's a good deal.", "sentence_ja": "それはお買い得だ（良い取引だ）。" },
            { "english": "survey", "japanese": "調査", "sentence": "We conducted a survey.", "sentence_ja": "私たちは調査を行った。" },
            { "english": "find out wh-節", "japanese": "･･･かを調べる", "sentence": "I need to find out who did this.", "sentence_ja": "誰がこれをしたのか調べる必要がある。" },
            { "english": "popularity", "japanese": "人気", "sentence": "The game is gaining popularity.", "sentence_ja": "そのゲームは人気を集めている。" },
            { "english": "see", "japanese": "･･･を経験する", "sentence": "We will see some changes.", "sentence_ja": "私たちはいくつかの変化を経験するだろう。" },
            { "english": "increase", "japanese": "増加", "sentence": "There is an increase in sales.", "sentence_ja": "売上の増加がある。" },
            { "english": "for some reason", "japanese": "どういうわけか", "sentence": "For some reason, I feel tired.", "sentence_ja": "どういうわけか、疲れている。" },
            { "english": "experience", "japanese": "･･･を経験する", "sentence": "He experienced many difficulties.", "sentence_ja": "彼は多くの困難を経験した。" },
            { "english": "regain", "japanese": "･･･を回復する", "sentence": "She regained her health.", "sentence_ja": "彼女は健康を回復した。" },
            { "english": "last", "japanese": "この:ここ最近の", "sentence": "I've been busy for the last few days.", "sentence_ja": "ここ数日忙しい。" },
            { "english": "considerable", "japanese": "かなりの", "sentence": "It cost a considerable amount.", "sentence_ja": "それはかなりの額がかかった。" },
            { "english": "in contrast", "japanese": "それとは対照的に", "sentence": "In contrast, she is very quiet.", "sentence_ja": "対照的に、彼女はとても静かだ。" },
            { "english": "once", "japanese": "ある時に", "sentence": "I met him once in Paris.", "sentence_ja": "私はパリで一度（ある時）彼に会った。" },
            { "english": "decline", "japanese": "減少", "sentence": "There was a decline in profits.", "sentence_ja": "利益の減少があった。" },
            { "english": "fill in", "japanese": "･･･を記入する", "sentence": "Fill in the blanks.", "sentence_ja": "空欄を埋めなさい。" },
            { "english": "weekly", "japanese": "毎週の:週に1度の", "sentence": "We have a weekly meeting.", "sentence_ja": "私たちは毎週の会議がある。" },
            { "english": "column", "japanese": "欄", "sentence": "Write in the correct column.", "sentence_ja": "正しい欄に書きなさい。" },
            { "english": "have O -ing", "japanese": "Oに-してもらう", "sentence": "I'll have him call you.", "sentence_ja": "彼に電話させます。" },
            { "english": "experienced", "japanese": "ベテランの:経験豊富な", "sentence": "He is an experienced teacher.", "sentence_ja": "彼は経験豊富な教師だ。" },
            { "english": "tough", "japanese": "タフな:たくましい", "sentence": "It was a tough game.", "sentence_ja": "それはタフな試合だった。" },
            { "english": "train", "japanese": "･･･を訓練する", "sentence": "They train dogs here.", "sentence_ja": "彼らはここで犬を訓練する。" },
            { "english": "newcomer", "japanese": "新人:初心者", "sentence": "I am a newcomer to this city.", "sentence_ja": "私はこの街の新参者だ。" },
            { "english": "ultimate", "japanese": "最も重要な", "sentence": "That is the ultimate goal.", "sentence_ja": "それが最終的な（最も重要な）目標だ。" },
            { "english": "symbolize", "japanese": "･･･を象徴する", "sentence": "The dove symbolizes peace.", "sentence_ja": "鳩は平和を象徴する。" },
            { "english": "rebirth", "japanese": "再生", "sentence": "Spring is a time of rebirth.", "sentence_ja": "春は再生の時だ。" },
            { "english": "symbolism", "japanese": "象徴的意味", "sentence": "The poem is full of symbolism.", "sentence_ja": "その詩は象徴的意味に満ちている。" },
            { "english": "poisonous", "japanese": "有毒な", "sentence": "Some mushrooms are poisonous.", "sentence_ja": "いくつかのキノコは有毒だ。" },
            { "english": "cling", "japanese": "くっつく", "sentence": "The baby clings to her mother.", "sentence_ja": "赤ちゃんは母親にくっつく。" },
            { "english": "symbol", "japanese": "象徴", "sentence": "The flag is a symbol of the country.", "sentence_ja": "旗はその国の象徴だ。" },
            { "english": "contain", "japanese": "･･･を含む", "sentence": "This box contains toys.", "sentence_ja": "この箱はおもちゃを含んでいる。" },
            { "english": "depending on...", "japanese": "･･･によって:･･･に応じて", "sentence": "Prices vary depending on the season.", "sentence_ja": "価格は季節によって異なる。" },
            { "english": "represent", "japanese": "･･･を象徴する", "sentence": "This color represents happiness.", "sentence_ja": "この色は幸福を象徴する。" },
            { "english": "respect", "japanese": "尊敬", "sentence": "He earned their respect.", "sentence_ja": "彼は彼らの尊敬を勝ち取った。" },
            { "english": "lovely", "japanese": "美しい", "sentence": "What a lovely garden!", "sentence_ja": "なんて美しい庭でしょう！" },
            { "english": "the language of flowers", "japanese": "花言葉", "sentence": "Do you know the language of flowers?", "sentence_ja": "花言葉を知っていますか？" },
            { "english": "joy", "japanese": "喜び", "sentence": "She jumped for joy.", "sentence_ja": "彼女は喜びで飛び上がった。" },
            { "english": "emerge", "japanese": "芽生える:現れる", "sentence": "The sun emerged from the clouds.", "sentence_ja": "太陽が雲から現れた。" },
            { "english": "thorn", "japanese": "とげ", "sentence": "Every rose has its thorn.", "sentence_ja": "バラにはとげがある。" },
            { "english": "as with...", "japanese": "･･･と同様に", "sentence": "As with many people, I like music.", "sentence_ja": "多くの人と同様に、私は音楽が好きだ。" },
            { "english": "pleasure", "japanese": "喜び", "sentence": "It's a pleasure to meet you.", "sentence_ja": "お会いできて嬉しいです（喜びです）。" },
            { "english": "various", "japanese": "さまざまな", "sentence": "There are various reasons.", "sentence_ja": "さまざまな理由がある。" },
            { "english": "wisdom", "japanese": "英知", "sentence": "He is a man of wisdom.", "sentence_ja": "彼は英知の人だ。" },
            { "english": "taste", "japanese": "･･･な味がする", "sentence": "This soup tastes good.", "sentence_ja": "このスープは良い味がする。" },
            { "english": "victory", "japanese": "勝利", "sentence": "They celebrated their victory.", "sentence_ja": "彼らは勝利を祝った。" },
            { "english": "contribute to...", "japanese": "･･･に貢献する:･･･の一助となる", "sentence": "Exercise contributes to health.", "sentence_ja": "運動は健康に貢献する。" },
            { "english": "physical", "japanese": "肉体的な", "sentence": "Physical exercise is important.", "sentence_ja": "肉体的な運動は重要だ。" },
            { "english": "well-being", "japanese": "健康;幸福", "sentence": "We care about your well-being.", "sentence_ja": "私たちはあなたの健康（幸福）を気にかけている。" },
            { "english": "sports-related", "japanese": "スポーツ関連の", "sentence": "He has a sports-related injury.", "sentence_ja": "彼はスポーツ関連の怪我をしている。" },
            { "english": "injury", "japanese": "怪我", "sentence": "He recovered from his injury.", "sentence_ja": "彼は怪我から回復した。" },
            { "english": "sustain", "japanese": "･･･を負う:･･･を被る", "sentence": "He sustained a serious injury.", "sentence_ja": "彼は深刻な怪我を負った。" },
            { "english": "lack", "japanese": "欠如:不足", "sentence": "The plant died from lack of water.", "sentence_ja": "その植物は水不足で枯れた。" },
            { "english": "proper", "japanese": "適切な", "sentence": "Use the proper tools.", "sentence_ja": "適切な道具を使いなさい。" },
            { "english": "certain", "japanese": "特定の", "sentence": "I have certain conditions.", "sentence_ja": "特定の条件がある。" },
            { "english": "equipment", "japanese": "装備:設備", "sentence": "We need new sports equipment.", "sentence_ja": "新しいスポーツ用具（装備）が必要だ。" },
            { "english": "measure", "japanese": "措置:対策", "sentence": "Safety measures are in place.", "sentence_ja": "安全対策が講じられている。" },
            { "english": "preventive", "japanese": "防御の:予防的な", "sentence": "Take preventive action.", "sentence_ja": "予防的な行動をとりなさい。" },
            { "english": "age-appropriate", "japanese": "年齢に適した", "sentence": "Choose age-appropriate toys.", "sentence_ja": "年齢に適したおもちゃを選びなさい。" },
            { "english": "pain", "japanese": "痛み", "sentence": "I feel pain in my leg.", "sentence_ja": "足に痛みを感じる。" },
            { "english": "combined", "japanese": "合同[共同]の", "sentence": "It was a combined effort.", "sentence_ja": "それは共同の努力だった。" },
            { "english": "excessive", "japanese": "過度の", "sentence": "Excessive noise is bad for ears.", "sentence_ja": "過度の騒音は耳に悪い。" },
            { "english": "gentle", "japanese": "穏やかな:緩い", "sentence": "Be gentle with the baby.", "sentence_ja": "赤ちゃんには穏やかに接しなさい。" },
            { "english": "mental", "japanese": "精神的な", "sentence": "Mental health is important.", "sentence_ja": "精神的な健康は重要だ。" },
            { "english": "irregular", "japanese": "不規則な", "sentence": "He has irregular working hours.", "sentence_ja": "彼は不規則な勤務時間だ。" },
            { "english": "open", "japanese": "率直な:隠し立てをしない", "sentence": "Be open about your feelings.", "sentence_ja": "感情について率直になりなさい。" },
            { "english": "be on the rise", "japanese": "増加している", "sentence": "Prices are on the rise.", "sentence_ja": "価格が増加している。" },
            { "english": "chance", "japanese": "可能性", "sentence": "There is a good chance of winning.", "sentence_ja": "勝つ可能性は十分にある。" },
            { "english": "result in...", "japanese": "･･･の結果になる", "sentence": "Carelessness results in accidents.", "sentence_ja": "不注意は事故の結果になる。" },
            { "english": "youth", "japanese": "若い世代:若者たち", "sentence": "The youth are the future.", "sentence_ja": "若者たちは未来だ。" },
            { "english": "injure", "japanese": "･･･に怪我をさせる", "sentence": "He injured his knee.", "sentence_ja": "彼は膝を怪我した。" },
            { "english": "over time", "japanese": "やがて:徐々に", "sentence": "Things will get better over time.", "sentence_ja": "徐々に良くなるだろう。" },
            { "english": "impact", "japanese": "衝撃:負担", "sentence": "The impact was strong.", "sentence_ja": "衝撃は強かった。" },
            { "english": "strain", "japanese": "･･･に負担をかける", "sentence": "Don't strain your eyes.", "sentence_ja": "目を酷使（負担をかけ）しないで。" },
            { "english": "safety", "japanese": "安全", "sentence": "Safety comes first.", "sentence_ja": "安全第一だ。" },
            { "english": "take the time to", "japanese": "-するために時間を割く", "sentence": "Take the time to read this.", "sentence_ja": "時間を割いてこれを読みなさい。" },
            { "english": "normally", "japanese": "通常", "sentence": "I normally wake up at 7.", "sentence_ja": "私は通常7時に起きる。" },
            { "english": "guidance", "japanese": "指導;助言", "sentence": "I need your guidance.", "sentence_ja": "あなたの指導が必要です。" },
            { "english": "team up", "japanese": "連携する:協力する", "sentence": "Let's team up for the project.", "sentence_ja": "プロジェクトのために協力しよう。" },
            { "english": "light", "japanese": "軽い", "sentence": "Let's do some light exercise.", "sentence_ja": "軽い運動をしよう。" },
            { "english": "prevent", "japanese": "･･･を防ぐ", "sentence": "This vaccine prevents flu.", "sentence_ja": "このワクチンはインフルエンザを防ぐ。" },
            { "english": "include", "japanese": "･･･を含む", "sentence": "The price includes tax.", "sentence_ja": "価格は税金を含んでいる。" },
            { "english": "reduce", "japanese": "･･･を減らす", "sentence": "We must reduce waste.", "sentence_ja": "私たちは無駄を減らさなければならない。" },
            { "english": "respectively", "japanese": "それぞれ", "sentence": "A and B scored 10 and 20 respectively.", "sentence_ja": "AとBはそれぞれ10点と20点を取った。" },
            { "english": "furthermore", "japanese": "さらに", "sentence": "Furthermore, it is free.", "sentence_ja": "さらに、それは無料だ。" },
            { "english": "avoid -ing", "japanese": "-するのを避ける", "sentence": "Avoid eating too much sugar.", "sentence_ja": "砂糖を食べ過ぎるのを避けなさい。" },
            { "english": "to sum up", "japanese": "要するに", "sentence": "To sum up, we need more time.", "sentence_ja": "要するに、もっと時間が必要だ。" },
            { "english": "honest", "japanese": "正直な", "sentence": "Give me an honest answer.", "sentence_ja": "正直な答えをください。" },
            { "english": "take O seriously", "japanese": "Oを真剣にとらえる", "sentence": "Take your studies seriously.", "sentence_ja": "勉強を真剣にとらえなさい。" },
            { "english": "percentage", "japanese": "割合", "sentence": "A high percentage of students passed.", "sentence_ja": "高い割合の生徒が合格した。" },
            { "english": "indoors", "japanese": "屋内で", "sentence": "Stay indoors today.", "sentence_ja": "今日は屋内にいなさい。" },
            { "english": "supervision", "japanese": "監督:管理", "sentence": "Children need supervision.", "sentence_ja": "子供たちは監督が必要だ。" },
            { "english": "close", "japanese": "綿密な:徹底的な", "sentence": "Pay close attention.", "sentence_ja": "綿密な注意を払いなさい。" },
            { "english": "occur", "japanese": "起こる:発生する", "sentence": "Accidents occur frequently.", "sentence_ja": "事故は頻繁に起こる。" },
            { "english": "instruction", "japanese": "指導", "sentence": "Follow the instructions.", "sentence_ja": "指示（指導）に従いなさい。" },
            { "english": "adequate", "japanese": "十分な:適切な", "sentence": "We have adequate supplies.", "sentence_ja": "十分な供給がある。" },
            { "english": "mental health", "japanese": "精神的健康", "sentence": "Take care of your mental health.", "sentence_ja": "精神的健康を大事にしなさい。" },
            { "english": "freely", "japanese": "自由に", "sentence": "You can speak freely.", "sentence_ja": "自由に話していいですよ。" },
            { "english": "pile", "japanese": "山", "sentence": "There is a pile of books.", "sentence_ja": "本の山がある。" },
            { "english": "waste", "japanese": "･･･を無駄にする", "sentence": "Don't waste time.", "sentence_ja": "時間を無駄にするな。" },
            { "english": "just because...", "japanese": "･･･という理由だけで", "sentence": "Just because it's cheap doesn't mean it's good.", "sentence_ja": "安いという理由だけで良いとは限らない。" },
            { "english": "at least", "japanese": "少なくとも", "sentence": "It costs at least $10.", "sentence_ja": "それは少なくとも10ドルする。" },
            { "english": "irritate", "japanese": "･･･をいらいらさせる", "sentence": "His behavior irritates me.", "sentence_ja": "彼の態度は私をいらいらさせる。" },
            { "english": "passenger", "japanese": "乗客", "sentence": "The train was full of passengers.", "sentence_ja": "電車は乗客でいっぱいだった。" },
            { "english": "rubbish", "japanese": "ごみ", "sentence": "Throw the rubbish in the bin.", "sentence_ja": "ごみを箱に捨てなさい。" },
            { "english": "keep up with...", "japanese": "･･･に遅れずに付いて行く", "sentence": "It's hard to keep up with the news.", "sentence_ja": "ニュースに遅れずについていくのは大変だ。" },
            { "english": "current affairs", "japanese": "時事問題", "sentence": "We discussed current affairs.", "sentence_ja": "私たちは時事問題について議論した。" },
            { "english": "latest", "japanese": "最新の", "sentence": "Have you heard the latest news?", "sentence_ja": "最新のニュースを聞きましたか？" },
            { "english": "online", "japanese": "オンラインで:インターネットで", "sentence": "I bought it online.", "sentence_ja": "私はそれをオンラインで買った。" },
            { "english": "pollute", "japanese": "･･･を汚染する", "sentence": "Cars pollute the air.", "sentence_ja": "車は空気を汚染する。" },
            { "english": "trust", "japanese": "･･･を信頼する", "sentence": "Trust me.", "sentence_ja": "私を信頼して。" },
            { "english": "prefer", "japanese": "･･･をより好む", "sentence": "I prefer tea to coffee.", "sentence_ja": "私はコーヒーより紅茶を好む。" },
            { "english": "detailed", "japanese": "詳細な", "sentence": "Give me a detailed report.", "sentence_ja": "詳細な報告をください。" },
            { "english": "professional", "japanese": "プロの:専門的な", "sentence": "He is a professional player.", "sentence_ja": "彼はプロの選手だ。" },
            { "english": "article", "japanese": "記事", "sentence": "I read an interesting article.", "sentence_ja": "私は面白い記事を読んだ。" },
            { "english": "journalist", "japanese": "ジャーナリスト:記者", "sentence": "She works as a journalist.", "sentence_ja": "彼女はジャーナリストとして働いている。" },
            { "english": "rather than...", "japanese": "･･･よりもむしろ", "sentence": "I walk rather than drive.", "sentence_ja": "私は運転するよりむしろ歩く。" },
            { "english": "fake", "japanese": "偽りの:でたらめな", "sentence": "That is fake news.", "sentence_ja": "それは偽のニュースだ。" },
            { "english": "be full of...", "japanese": "･･･でいっぱいである", "sentence": "The basket is full of apples.", "sentence_ja": "バスケットはリンゴでいっぱいだ。" },
            { "english": "unreliable", "japanese": "信用できない", "sentence": "This information is unreliable.", "sentence_ja": "この情報は信用できない。" },
            { "english": "carry around", "japanese": "･･･を持ち歩く", "sentence": "I carry my phone around.", "sentence_ja": "私は電話を持ち歩く。" },
            { "english": "subscribe to...", "japanese": "･･･を定期購読する", "sentence": "Subscribe to our newsletter.", "sentence_ja": "私たちのニュースレターを定期購読してください。" },
            { "english": "newspaper agency", "japanese": "新聞販売店", "sentence": "Call the newspaper agency.", "sentence_ja": "新聞販売店に電話しなさい。" },
            { "english": "post", "japanese": "･･･を投稿する", "sentence": "He posted a photo online.", "sentence_ja": "彼はオンラインに写真を投稿した。" },
            { "english": "shared house", "japanese": "シェアハウス", "sentence": "They live in a shared house.", "sentence_ja": "彼らはシェアハウスに住んでいる。" },
            { "english": "advantage", "japanese": "利点;長所", "sentence": "What is the advantage of this?", "sentence_ja": "これの利点は何ですか？" },
            { "english": "all by oneself", "japanese": "自分だけで", "sentence": "He lives all by himself.", "sentence_ja": "彼は自分だけで（一人きりで）住んでいる。" },
            { "english": "for one", "japanese": "1つには", "sentence": "For one, it's cheaper.", "sentence_ja": "一つには、それはより安い。" },
            { "english": "split A with B", "japanese": "AをBと割り勘にする", "sentence": "Let's split the bill with friends.", "sentence_ja": "請求書を友達と割り勘にしよう。" },
            { "english": "utility cost", "japanese": "光熱費", "sentence": "Utility costs are rising.", "sentence_ja": "光熱費が上がっている。" },
            { "english": "plus", "japanese": "その上", "sentence": "It's cold, plus it's raining.", "sentence_ja": "寒いし、その上雨が降っている。" },
            { "english": "opportunity", "japanese": "機会", "sentence": "This is a great opportunity.", "sentence_ja": "これは素晴らしい機会だ。" },
            { "english": "provide", "japanese": "･･･を提供する", "sentence": "They provide food for the poor.", "sentence_ja": "彼らは貧しい人々に食料を提供する。" },
            { "english": "socialize", "japanese": "人付き合いをする:社交的にする", "sentence": "I like to socialize at parties.", "sentence_ja": "私はパーティーで人付き合いをするのが好きだ。" },
            { "english": "retired", "japanese": "退職した", "sentence": "He is a retired teacher.", "sentence_ja": "彼は退職した教師だ。" },
            { "english": "apparently", "japanese": "見たところ:どうやら･･･らしい", "sentence": "Apparently, he is rich.", "sentence_ja": "どうやら彼は金持ちのようだ。" },
            { "english": "housemate", "japanese": "同居人", "sentence": "My housemate is very tidy.", "sentence_ja": "私の同居人はとてもきれい好きだ。" },
            { "english": "clean up after...", "japanese": "･･･が汚した場所をきれいにする", "sentence": "Clean up after yourself.", "sentence_ja": "自分の汚した場所は自分で片付けなさい。" },
            { "english": "drive... crazy", "japanese": "･･･を激怒させる", "sentence": "The noise drives me crazy.", "sentence_ja": "その騒音は私を激怒させる（気が変になりそうだ）。" },
            { "english": "focus on...", "japanese": "･･･に集中する", "sentence": "Focus on your work.", "sentence_ja": "仕事に集中しなさい。" },
            { "english": "personality", "japanese": "性格", "sentence": "She has a nice personality.", "sentence_ja": "彼女は良い性格をしている。" },
            { "english": "fit in with...", "japanese": "･･･になじむ:･･･に適合する", "sentence": "He fits in with the team.", "sentence_ja": "彼はチームになじんでいる。" },
            { "english": "communal", "japanese": "共同の:集団の", "sentence": "We share a communal kitchen.", "sentence_ja": "私たちは共同のキッチンを共有している。" },
            { "english": "fantastic", "japanese": "夢のような:素晴らしい", "sentence": "The view is fantastic.", "sentence_ja": "景色は素晴らしい。" },
            { "english": "value", "japanese": "･･･を重視する", "sentence": "I value your opinion.", "sentence_ja": "私はあなたの意見を重視する。" },
            { "english": "Me neither.", "japanese": "私もそうでない", "sentence": "\"I don't like it.\" \"Me neither.\"", "sentence_ja": "「それは好きじゃない」「私も（好きじゃない）」" },
            { "english": "would rather-", "japanese": "むしろ-したい", "sentence": "I would rather stay home.", "sentence_ja": "私はむしろ家にいたい。" },
            { "english": "distraction", "japanese": "気を散らすもの", "sentence": "Avoid distractions while studying.", "sentence_ja": "勉強中は気を散らすものを避けなさい。" }
        ];

        // --- APP STATE ---
        let selectedWords = [];
        let currentWordIndex = 0;
        let learningMode = 'word';
        let quizQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let incorrectAnswers = [];
        let voices = [];
        let recognition;
        let mediaRecorder;
        let audioChunks = [];
        let recordedAudioURL = null;

        // --- DOM Elements ---
        const els = {
            setupSection: document.getElementById('setup-section'),
            learningSection: document.getElementById('learning-section'),
            testOptionsSection: document.getElementById('test-options-section'),
            quizSection: document.getElementById('quiz-section'),
            resultsSection: document.getElementById('results-section'),
            wordList: document.getElementById('word-list'),
            flashcardContainer: document.getElementById('flashcard-container'),
            englishText: document.getElementById('english-text'),
            japaneseWrapper: document.getElementById('japanese-wrapper'),
            japaneseText: document.getElementById('japanese-text'),
            progressIndicator: document.getElementById('progress-indicator'),
            illustrationArea: document.getElementById('illustration-area'),
            pronunciationFeedback: document.getElementById('pronunciation-feedback-container'),
            micIcon: document.getElementById('mic-icon'),
            recordingPlayer: document.getElementById('recording-player')
        };

        // --- INIT ---
        document.addEventListener('DOMContentLoaded', () => {
            renderWordList();
            initSpeech();
            switchSection('setup');
        });

        // --- FUNCTIONS ---

        function renderWordList() {
            els.wordList.innerHTML = '';
            vocabularyData.forEach((word, index) => {
                const div = document.createElement('div');
                div.className = 'relative flex items-start p-3 bg-white border border-slate-200 rounded-lg hover:border-brand-300 transition-colors cursor-pointer group';
                div.innerHTML = `
                    <div class="flex items-center h-5">
                        <input type="checkbox" class="word-checkbox" data-index="${index}">
                    </div>
                    <div class="ml-3 text-sm">
                        <label class="font-bold text-slate-800 block cursor-pointer group-hover:text-brand-600">${word.english}</label>
                        <p class="text-slate-500 text-xs mt-1 cursor-pointer">${word.japanese}</p>
                    </div>
                `;
                div.addEventListener('click', (e) => {
                    if (e.target.type !== 'checkbox') {
                        const cb = div.querySelector('input');
                        cb.checked = !cb.checked;
                    }
                });
                els.wordList.appendChild(div);
            });
        }

        function switchSection(name) {
            ['setupSection', 'learningSection', 'testOptionsSection', 'quizSection', 'resultsSection'].forEach(k => {
                els[k].classList.add('hidden');
                els[k].classList.remove('animate-fade-in');
            });
            const target = els[name + 'Section'];
            target.classList.remove('hidden');
            requestAnimationFrame(() => target.classList.add('animate-fade-in'));
        }

        // --- LEARNING LOGIC ---

        function updateCard() {
            const word = selectedWords[currentWordIndex];
            const mode = document.querySelector('input[name="mode"]:checked').value;
            
            // Reset View
            els.japaneseWrapper.classList.remove('opacity-100', 'translate-y-0');
            els.japaneseWrapper.classList.add('opacity-0', 'translate-y-4');
            els.pronunciationFeedback.innerHTML = '';
            els.englishText.className = "text-3xl sm:text-4xl md:text-5xl font-bold text-slate-800 mb-6 leading-tight select-text";

            if (mode === 'sentence' && word.sentence) {
                els.illustrationArea.classList.remove('hidden');
                
                // --- Highlight Logic Start ---
                let sentenceHtml = word.sentence;
                
                try {
                    // 1. Clean up the header word (remove non-alphanumeric except spaces)
                    const cleanEnglish = word.english.replace(/[^a-zA-Z0-9\s]/g, ' ').replace(/\s+/g, ' ').trim();
                    
                    // 2. Split into tokens
                    let tokens = cleanEnglish.split(' ').filter(t => t.length > 0);
                    
                    // 3. Expand common irregular verbs for better matching
                    const expandedTokens = [];
                    tokens.forEach(t => {
                        expandedTokens.push(t);
                        const lower = t.toLowerCase();
                        if (lower === 'be') expandedTokens.push('am', 'is', 'are', 'was', 'were', 'being', 'been');
                        if (lower === 'have') expandedTokens.push('has', 'had');
                        if (lower === 'do') expandedTokens.push('does', 'did', 'done');
                        if (lower === 'go') expandedTokens.push('goes', 'went', 'gone');
                        if (lower === 'see') expandedTokens.push('saw', 'seen');
                    });
                    
                    // Remove duplicates
                    const uniqueTokens = [...new Set(expandedTokens)];

                    // 4. Create Regex
                    // Match whole words that start with the token (to handle plurals/tense changes roughly like 'suggest' -> 'suggested')
                    // Sort by length desc to match longer words first (though regex OR usually matches first found, length sort helps in some engines)
                    uniqueTokens.sort((a, b) => b.length - a.length);
                    
                    if (uniqueTokens.length > 0) {
                        const pattern = uniqueTokens.map(t => {
                            const escaped = t.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                            // \b ensures we don't match inside other words (e.g. "a" in "apple")
                            // \w* allows for suffixes (ed, s, ing etc)
                            return `\\b${escaped}\\w*`;
                        }).join('|');
                        
                        const regex = new RegExp(`(${pattern})`, 'gi');
                        sentenceHtml = word.sentence.replace(regex, '<span class="text-brand-600 border-b-2 border-brand-200">$1</span>');
                    }
                } catch (e) {
                    console.error("Highlight error", e);
                    sentenceHtml = word.sentence; // Fallback
                }
                // --- Highlight Logic End ---

                els.englishText.innerHTML = sentenceHtml;
                els.japaneseText.innerHTML = word.sentence_ja || word.japanese;
                
                // Adjust font size for long sentences
                if (word.sentence.length > 50) {
                    els.englishText.classList.remove('text-3xl', 'sm:text-4xl', 'md:text-5xl');
                    els.englishText.classList.add('text-xl', 'md:text-2xl');
                } else {
                    els.englishText.classList.remove('text-5xl');
                    els.englishText.classList.add('text-2xl', 'md:text-3xl');
                }
                
            } else {
                els.illustrationArea.classList.add('hidden');
                els.englishText.textContent = word.english;
                els.japaneseText.textContent = word.japanese;
            }

            els.progressIndicator.textContent = `${currentWordIndex + 1} / ${selectedWords.length}`;
            
            // Button States
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            prevBtn.disabled = currentWordIndex === 0;
            nextBtn.disabled = currentWordIndex === selectedWords.length - 1;
            prevBtn.classList.toggle('opacity-50', prevBtn.disabled);
            nextBtn.classList.toggle('opacity-50', nextBtn.disabled);
        }

        // --- QUIZ LOGIC ---
        function generateQuiz(count) {
            const pool = [...selectedWords].sort(() => 0.5 - Math.random()).slice(0, count);
            quizQuestions = pool.map(w => {
                const correct = w.japanese;
                const distractors = vocabularyData
                    .filter(x => x.japanese !== correct)
                    .sort(() => 0.5 - Math.random())
                    .slice(0, 3)
                    .map(x => x.japanese);
                return {
                    q: w.english,
                    correct,
                    opts: [correct, ...distractors].sort(() => 0.5 - Math.random())
                };
            });
            score = 0;
            currentQuestionIndex = 0;
            incorrectAnswers = [];
            showQuizQuestion();
            switchSection('quiz');
        }

        function showQuizQuestion() {
            const q = quizQuestions[currentQuestionIndex];
            document.getElementById('quiz-question').textContent = q.q;
            document.getElementById('quiz-progress').textContent = `${currentQuestionIndex + 1}/${quizQuestions.length}`;
            const optsEl = document.getElementById('quiz-options');
            optsEl.innerHTML = '';
            document.getElementById('feedback').innerHTML = '';
            document.getElementById('next-question-btn').classList.add('hidden');

            q.opts.forEach(opt => {
                const btn = document.createElement('div');
                btn.className = 'quiz-option text-lg font-medium';
                btn.textContent = opt;
                btn.onclick = () => handleAnswer(btn, opt, q);
                optsEl.appendChild(btn);
            });
        }

        function handleAnswer(btn, ans, q) {
            if (document.querySelector('.quiz-option.correct')) return; // Already answered

            const isCorrect = ans === q.correct;
            if (isCorrect) {
                btn.classList.add('correct');
                document.getElementById('feedback').innerHTML = '<span class="text-green-600"><i class="fas fa-check-circle"></i> 正解!</span>';
                score++;
            } else {
                btn.classList.add('incorrect');
                // Highlight correct
                [...document.querySelectorAll('.quiz-option')].forEach(el => {
                    if (el.textContent === q.correct) el.classList.add('correct');
                });
                document.getElementById('feedback').innerHTML = `<span class="text-red-500"><i class="fas fa-times-circle"></i> 正解: ${q.correct}</span>`;
                incorrectAnswers.push({q: q.q, a: q.correct});
            }
            document.getElementById('next-question-btn').classList.remove('hidden');
        }

        // --- AUDIO ---
        function initSpeech() {
            if ('speechSynthesis' in window) {
                const loadVoices = () => {
                    voices = window.speechSynthesis.getVoices();
                };
                window.speechSynthesis.onvoiceschanged = loadVoices;
                loadVoices();
            }
            
            window.SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            if (!window.SpeechRecognition) {
                document.getElementById('record-btn').classList.add('btn-disabled');
                document.getElementById('record-btn').title = "このブラウザは音声認識をサポートしていません";
            }
        }

        function speakText(text) {
            window.speechSynthesis.cancel();
            const u = new SpeechSynthesisUtterance(text.replace(/<[^>]*>/g, ''));
            u.lang = 'en-US';
            u.rate = 1.0; 
            
            // Prioritize American voices
            let v = voices.find(x => x.name.includes('Google US English'));
            if(!v) v = voices.find(x => x.name.includes('Samantha')); // iOS
            if(!v) v = voices.find(x => x.lang === 'en-US');
            
            if (v) u.voice = v;
            window.speechSynthesis.speak(u);
        }

        // --- EVENT HANDLERS ---
        document.getElementById('select-all').onclick = () => document.querySelectorAll('.word-checkbox').forEach(c => c.checked = true);
        document.getElementById('deselect-all').onclick = () => document.querySelectorAll('.word-checkbox').forEach(c => c.checked = false);
        
        document.getElementById('start-learning-btn').onclick = () => {
            const checks = document.querySelectorAll('.word-checkbox:checked');
            if (!checks.length) return alert('単語を選択してください');
            selectedWords = Array.from(checks).map(c => vocabularyData[c.dataset.index]);
            currentWordIndex = 0;
            updateCard();
            switchSection('learning');
        };

        document.getElementById('quick-test-btn').onclick = () => {
            const checks = document.querySelectorAll('.word-checkbox:checked');
            if (!checks.length) return alert('単語を選択してください');
            selectedWords = Array.from(checks).map(c => vocabularyData[c.dataset.index]);
            
            // Show options
            const div = document.getElementById('test-choices');
            div.innerHTML = '';
            [10, 20, selectedWords.length].filter((v, i, a) => a.indexOf(v) === i && v <= selectedWords.length).sort((a,b)=>a-b).forEach(n => {
                const b = document.createElement('button');
                b.className = 'btn btn-primary w-24 h-24 flex flex-col items-center justify-center text-xl shadow-lg';
                b.innerHTML = `<span class="font-bold text-3xl">${n}</span><span class="text-xs">問</span>`;
                b.onclick = () => generateQuiz(n);
                div.appendChild(b);
            });
            switchSection('testOptions');
        };

        els.flashcardContainer.onclick = () => {
            els.japaneseWrapper.classList.toggle('opacity-0');
            els.japaneseWrapper.classList.toggle('opacity-100');
            els.japaneseWrapper.classList.toggle('translate-y-4');
            els.japaneseWrapper.classList.toggle('translate-y-0');
        };

        document.getElementById('prev-btn').onclick = () => {
            if (currentWordIndex > 0) { currentWordIndex--; updateCard(); }
        };
        document.getElementById('next-btn').onclick = () => {
            if (currentWordIndex < selectedWords.length - 1) { currentWordIndex++; updateCard(); }
        };
        document.getElementById('speak-btn').onclick = (e) => {
            e.stopPropagation();
            speakText(els.englishText.textContent);
        };

        // Recording Logic
        document.getElementById('record-btn').onclick = async (e) => {
            e.stopPropagation();
            if (!window.SpeechRecognition) return alert('このブラウザは音声認識をサポートしていません');
            
            if (recognition && recognition.started) {
                recognition.stop();
                if (mediaRecorder && mediaRecorder.state === 'recording') mediaRecorder.stop();
                return;
            }

            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                mediaRecorder = new MediaRecorder(stream);
                audioChunks = [];
                mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
                mediaRecorder.onstop = () => {
                    const blob = new Blob(audioChunks, { type: 'audio/wav' });
                    recordedAudioURL = URL.createObjectURL(blob);
                    els.recordingPlayer.src = recordedAudioURL;
                    document.getElementById('play-recording-btn').disabled = false;
                    document.getElementById('play-recording-btn').classList.remove('btn-disabled');
                    els.micIcon.classList.remove('recording');
                    els.micIcon.className = 'fas fa-microphone text-2xl';
                    stream.getTracks().forEach(t => t.stop());
                };
                mediaRecorder.start();

                recognition = new SpeechRecognition();
                recognition.lang = 'en-US';
                recognition.interimResults = false;
                recognition.maxAlternatives = 1;
                recognition.started = true;
                
                els.micIcon.className = 'fas fa-stop text-2xl';
                els.micIcon.classList.add('recording');
                els.pronunciationFeedback.innerHTML = '<span class="text-brand-500 animate-pulse">Listening...</span>';

                recognition.onresult = (ev) => {
                    const transcript = ev.results[0][0].transcript;
                    const target = els.englishText.textContent.replace(/<[^>]*>/g, '');
                    
                    // Simple similarity check (Levenshtein based logic)
                    const normalize = s => s.toLowerCase().replace(/[^a-z0-9]/g, '');
                    const s1 = normalize(transcript);
                    const s2 = normalize(target);
                    
                    // Calculation for scoring
                    let matches = 0;
                    const len = Math.max(s1.length, s2.length);
                    for(let i=0; i<Math.min(s1.length, s2.length); i++) {
                        if(s1[i] === s2[i]) matches++;
                    }
                    // Boost score for partial matches to be "lenient" (甘め)
                    let score = 0;
                    if (s1 === s2) score = 100;
                    else if (s1.includes(s2) || s2.includes(s1)) score = 90;
                    else score = Math.round((matches / len) * 100);
                    
                    // Adjust score to be lenient
                    if(score < 40 && score > 10) score += 30; 
                    if(score > 70) score = 100;

                    let msg = '', color = '';
                    if (score >= 80) { msg = 'Excellent!'; color = 'text-green-600'; }
                    else if (score >= 50) { msg = 'Good job!'; color = 'text-blue-500'; }
                    else { msg = 'Try again'; color = 'text-red-500'; }
                    
                    els.pronunciationFeedback.innerHTML = `
                        <div class="flex flex-col items-center">
                            <span class="text-xs text-slate-400">You said: "${transcript}"</span>
                            <span class="text-xl font-bold ${color}">${msg} (${score}%)</span>
                        </div>
                    `;
                };
                recognition.onerror = (e) => {
                     console.error(e);
                     els.pronunciationFeedback.innerHTML = '<span class="text-red-400">Error. Try again.</span>';
                     recognition.stop();
                }
                recognition.onend = () => {
                    recognition.started = false;
                    els.micIcon.classList.remove('recording');
                    els.micIcon.className = 'fas fa-microphone text-2xl';
                    if (mediaRecorder && mediaRecorder.state === 'recording') mediaRecorder.stop();
                };
                recognition.start();

            } catch (err) {
                console.error(err);
                alert('マイクへのアクセスを許可してください');
            }
        };

        document.getElementById('play-recording-btn').onclick = (e) => {
            e.stopPropagation();
            els.recordingPlayer.play();
        };

        // Navigation
        document.getElementById('back-to-learning-btn').onclick = () => switchSection('setup');
        document.getElementById('back-to-setup-btn').onclick = () => switchSection('setup');
        document.getElementById('back-to-home-btn').onclick = () => switchSection('setup');
        document.getElementById('abort-test-btn').onclick = () => switchSection('setup');
        
        document.getElementById('next-question-btn').onclick = () => {
            currentQuestionIndex++;
            if (currentQuestionIndex < quizQuestions.length) {
                showQuizQuestion();
            } else {
                // Show results
                document.getElementById('score-percentage').textContent = Math.round(score / quizQuestions.length * 100) + '%';
                document.getElementById('score-text').textContent = `${score} / ${quizQuestions.length} 正解`;
                const list = document.getElementById('incorrect-answers-list');
                list.innerHTML = '';
                if (incorrectAnswers.length) {
                    document.getElementById('incorrect-answers-container').classList.remove('hidden');
                    incorrectAnswers.forEach(item => {
                        const li = document.createElement('li');
                        li.className = "bg-white p-3 rounded border border-red-100 text-sm";
                        li.innerHTML = `<div class="font-bold text-slate-800">${item.q}</div><div class="text-red-500">正解: ${item.a}</div>`;
                        list.appendChild(li);
                    });
                } else {
                    document.getElementById('incorrect-answers-container').classList.add('hidden');
                }
                switchSection('results');
            }
        };

        document.getElementById('start-test-btn').onclick = () => {
            generateQuiz(Math.min(10, selectedWords.length));
        };
        
        document.getElementById('restart-btn').onclick = () => switchSection('setup');

        // PDF Generation
        document.getElementById('download-pdf-btn').onclick = () => document.getElementById('pdf-modal').classList.remove('hidden');
        document.getElementById('close-modal-btn').onclick = () => document.getElementById('pdf-modal').classList.add('hidden');
        document.getElementById('close-modal-icon').onclick = () => document.getElementById('pdf-modal').classList.add('hidden');

        const pdfActions = [
            { id: 'download-list-btn', title: '単語リスト', content: (ws) => `<ul style="column-count:2; gap:40px; list-style-type: none; padding: 0;">${ws.map((w, i) => `<li style="margin-bottom:10px; break-inside: avoid;"><span style="display:inline-block; width: 30px; color:#666;">${i+1}.</span> <b>${w.english}</b>: ${w.japanese}</li>`).join('')}</ul>` },
            { id: 'download-en-quiz-btn', title: '英単語テスト', content: (ws) => `<h2>問題</h2><ol>${ws.map(w => `<li style="margin-bottom:15px;">${w.japanese}: ______________</li>`).join('')}</ol><h2 style="page-break-before:always;">解答</h2><ol>${ws.map(w => `<li>${w.english}</li>`).join('')}</ol>` },
            { id: 'download-ja-quiz-btn', title: '和訳テスト', content: (ws) => `<h2>問題</h2><ol>${ws.map(w => `<li style="margin-bottom:15px;">${w.english}: ______________</li>`).join('')}</ol><h2 style="page-break-before:always;">解答</h2><ol>${ws.map(w => `<li>${w.japanese}</li>`).join('')}</ol>` },
            { id: 'download-mixed-quiz-btn', title: '混合テスト', content: (ws) => {
                const shuf = [...ws].sort(()=>0.5-Math.random());
                const qs = shuf.map(w => Math.random()>0.5 ? `${w.japanese}: ______________` : `${w.english}: ______________`);
                const as = shuf.map((w,i) => qs[i].startsWith(w.japanese) ? w.english : w.japanese);
                return `<h2>問題</h2><ol>${qs.map(q=>`<li style="margin-bottom:15px;">${q}</li>`).join('')}</ol><h2 style="page-break-before:always;">解答</h2><ol>${as.map(a=>`<li>${a}</li>`).join('')}</ol>`;
            }},
            { id: 'download-sentence-quiz-btn', title: '例文穴埋め', content: (ws) => {
                const valid = ws.filter(w => w.sentence);
                if (!valid.length) return '例文がありません';
                return `<h2>問題</h2><ol>${valid.map(w => {
                    const k = w.english.split(' ')[0].replace(/[^\w]/g,'');
                    // Avoid duplicate numbering in PDF by relying on <ol>
                    return `<li style="margin-bottom:15px;">${w.sentence.replace(new RegExp(k+'\\w*','i'), '_______')}<br><small>${w.sentence_ja||w.japanese}</small></li>`;
                }).join('')}</ol><h2 style="page-break-before:always;">解答</h2><ol>${valid.map(w=>`<li>${w.english}</li>`).join('')}</ol>`;
            }},
            { id: 'download-sentence-mixed-quiz-btn', title: '例文実戦テスト', content: (ws) => {
                const valid = ws.filter(w => w.sentence);
                if (!valid.length) return '例文がありません';
                const qs = [], as = [];
                valid.sort(()=>0.5-Math.random()).forEach(w => {
                    const k = w.english.split(' ')[0].replace(/[^\w]/g,'');
                    if(Math.random()>0.5) {
                        qs.push(`${w.sentence.replace(new RegExp(k+'\\w*','i'), '_______')}<br><small>${w.sentence_ja||w.japanese}</small>`);
                        as.push(w.english);
                    } else {
                        qs.push(`${w.sentence.replace(new RegExp(`(${k}\\w*)`,'i'), '<u>$1</u>')}<br>下線部和訳: __________________`);
                        as.push(w.japanese);
                    }
                });
                return `<h2>問題</h2><ol>${qs.map(q=>`<li style="margin-bottom:15px;">${q}</li>`).join('')}</ol><h2 style="page-break-before:always;">解答</h2><ol>${as.map(a=>`<li>${a}</li>`).join('')}</ol>`;
            }}
        ];

        pdfActions.forEach(act => {
            document.getElementById(act.id).onclick = () => {
                const checks = document.querySelectorAll('.word-checkbox:checked');
                if (!checks.length) return alert('単語を選択してください');
                const words = Array.from(checks).map(c => vocabularyData[c.dataset.index]);
                const w = window.open('', '_blank');
                w.document.write(`<html><head><title>${act.title}</title><style>body{font-family:sans-serif;margin:30px;}h2{border-bottom:1px solid #000; margin-top: 20px;} li {margin-bottom: 10px;}</style></head><body><h1>${act.title}</h1>${act.content(words)}</body></html>`);
                w.document.close();
                setTimeout(() => w.print(), 500);
            };
        });

    </script>
</body>
</html>